<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sé«˜ãƒ»Så®‰ å±¥æ­´</title>

    <link rel="icon" type="image/png" href="icon.png">
    <link rel="apple-touch-icon" href="icon.png">
    <meta name="apple-mobile-web-app-title" content="Sé«˜å±¥æ­´">

    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500;700&family=Noto+Sans+JP:wght@500;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- å…¨ä½“è¨­å®š --- */
        body {
            font-family: 'Roboto', 'Noto Sans JP', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            padding-top: 60px; /* ãƒ˜ãƒƒãƒ€ãƒ¼ã®é«˜ã• */
            -webkit-text-size-adjust: 100%;
        }

        /* --- å›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼ --- */
        .fixed-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 50px;
            background-color: #f5f5f5; /* èƒŒæ™¯ã¯ç™½ç³»ã§ã‚·ãƒ³ãƒ—ãƒ«ã« */
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .app-title {
            color: #333;
            font-size: 18px;
            font-weight: bold;
            margin: 0;
            display: flex;
            align-items: center;
        }
        
        /* ã‚¿ã‚¤ãƒˆãƒ«ã®ã‚¢ã‚¤ã‚³ãƒ³ */
        .title-icon {
            margin-right: 8px;
            font-size: 20px;
        }

        /* --- ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³ --- */
        .table-container {
            width: 100%;
            background-color: white;
            overflow-x: hidden;
        }

        table {
            width: 100%;
            table-layout: fixed; /* åˆ—å¹…å›ºå®š */
            border-collapse: collapse;
            font-size: 11px; /* ã‚¹ãƒãƒ›ã§è¦‹ã‚„ã™ã„ã‚µã‚¤ã‚º */
        }

        th {
            background-color: #e91e63; /* æ¿ƒã„ãƒ”ãƒ³ã‚¯ */
            color: white;
            padding: 10px 2px;
            font-weight: bold;
            text-align: center;
            position: sticky;
            top: 50px; /* ãƒ˜ãƒƒãƒ€ãƒ¼ã®ä¸‹ã«å›ºå®š */
            z-index: 10;
            white-space: nowrap;
        }

        td {
            padding: 12px 4px; /* ã‚¿ãƒƒãƒ—ã—ã‚„ã™ã„ã‚ˆã†ã«å°‘ã—åºƒã‚ã« */
            border-bottom: 1px solid #eee;
            vertical-align: middle;
            line-height: 1.4;
        }

        /* --- æ—¥ä»˜åŒºåˆ‡ã‚Šã®å¤ªç·š --- */
        tr.date-separator {
            border-top: 4px solid #ddd; /* ã‚°ãƒ¬ãƒ¼ã®å¤ªç·š */
        }

        /* --- åˆ—å¹…èª¿æ•´ (iPhone15æœ€é©åŒ–) --- */
        /* åˆ—: [æ—¥ä»˜, çŠ¶æ…‹, ã‚³ãƒ¼ãƒ‰, éŠ˜æŸ„, ç¾åœ¨å€¤, å‰æ—¥æ¯”] */
        th:nth-child(1), td:nth-child(1) { width: 14%; text-align: center; font-size: 10px; color: #666; } /* æ—¥ä»˜ */
        th:nth-child(2), td:nth-child(2) { width: 10%; text-align: center; font-weight: bold; } /* çŠ¶æ…‹ */
        th:nth-child(3), td:nth-child(3) { width: 18%; text-align: center; } /* ã‚³ãƒ¼ãƒ‰(ãƒªãƒ³ã‚¯å«ã‚€) */
        th:nth-child(4), td:nth-child(4) { width: 28%; text-align: left; font-weight: bold; white-space: normal; word-break: break-all;} /* éŠ˜æŸ„ */
        th:nth-child(5), td:nth-child(5) { width: 15%; text-align: right; } /* ç¾åœ¨å€¤ */
        th:nth-child(6), td:nth-child(6) { width: 15%; text-align: right; } /* å‰æ—¥æ¯” */

        /* --- ãƒªãƒ³ã‚¯ãƒœã‚¿ãƒ³è£…é£¾ --- */
        .link-icon {
            text-decoration: none;
            display: inline-block;
            margin-left: 2px;
            vertical-align: middle;
        }
        /* Yahooã‚¢ã‚¤ã‚³ãƒ³é¢¨ */
        .yahoo-btn {
            background-color: #ff0033; /* Y!ã®èµ¤ */
            color: white;
            font-size: 9px;
            padding: 1px 3px;
            border-radius: 2px;
            font-weight: bold;
            font-family: sans-serif;
        }
        /* ãƒãƒ£ãƒ¼ãƒˆã‚¢ã‚¤ã‚³ãƒ³é¢¨ */
        .chart-icon {
            color: #e91e63;
            font-size: 14px;
        }

        /* æ–‡å­—è‰² */
        .text-red { color: #cc0000; }
        .text-blue { color: #0000cc; }
        .text-black { color: #000; }

        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
        #loading {
            text-align: center;
            padding: 50px;
            color: #666;
            font-size: 14px;
        }
    </style>
</head>
<body>

    <div class="fixed-header">
        <h1 class="app-title">
            <span class="title-icon">ğŸ“ˆ</span>ã‚¹ãƒˆãƒƒãƒ—é«˜ãƒ»ã‚¹ãƒˆãƒƒãƒ—å®‰ å±¥æ­´
        </h1>
    </div>

    <div id="loading">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
    <div class="table-container">
        <table id="stockTable">
            </table>
    </div>

    <script>
        // â˜…â˜…â˜… GASã®URL (æœ€æ–°ç‰ˆ) â˜…â˜…â˜…
        const gasUrl = "https://script.google.com/macros/s/AKfycbyc8KXuA7A_-4_LpTY6RO0Ip9r3ED_g9NtMDgtbzLgpH-hwtouK8db3Zp_8sls-jVVk/exec";
